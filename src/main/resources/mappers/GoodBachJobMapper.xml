<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ht.project.snsproject.mapper.GoodBachJobMapper">

    <!--id 반드시 포함. primary key 혹은 unique key 가 지정되어 있지 않으면 중복제거가 제대로 이루어지지 않음.-->
    <insert id="batchUpdateFeedInfo" parameterType="java.util.List">
        INSERT INTO feeds(id, userId, title, content, publicScope, date, good)
        VALUES
        <foreach item="item" index="index" collection="list" separator=",">
            (#{item.feedId}, #{item.userId}, #{item.title}, #{item.content}, #{item.publicScope}, #{item.date}, #{item.good})
        </foreach>
        ON DUPLICATE KEY UPDATE
        good = VALUES(good)
    </insert>

    <!--feedId, userId 복합 UNIQUE KEY 지정-->
    <insert id="batchUpdateGoodUserList" parameterType="java.util.List">
        INSERT INTO goods(feedId, userId)
        VALUES
        <foreach item="item" index="index" collection="list" separator=",">
            (#{item.feedId}, #{item.userId})
        </foreach>
        ON DUPLICATE KEY UPDATE
        userId = VALUES(userId)
    </insert>
</mapper>